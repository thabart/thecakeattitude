<html>
	<head>		
		<meta charset="utf-8">
		<title>Cake attitude</title>
		<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2" />
		<!-- Jquery -->
		<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.js"></script>
		<!-- Bootstrap -->
		<script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.4.0/js/tether.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.0.0-alpha.6/js/bootstrap.js"></script>
		<!-- Phaser lib -->
		<script src="https://cdnjs.cloudflare.com/ajax/libs/phaser/2.6.2/phaser.js"></script>
		<!-- CSS Libraries -->
		<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.0.0-alpha.6/css/bootstrap.css">
		<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css" >
		<style type="text/css">	
		</style>
	</head>
	<body>
	</body>
	<script type="text/javascript">
		$(document).ready(function() {			
			var game = new Phaser.Game(800, 600, Phaser.AUTO, 'Cake attitute', { preload : preload, create, create, update });
			function preload() {
				// Load phaser map : http://examples.phaser.io/_site/view_full.html?d=loader&f=load+tilemap+json.js&t=load%20tilemap%20json
				game.load.tilemap('game', 'http://localhost:3000/public/map/map.json', null, Phaser.Tilemap.TILED_JSON);
				game.load.image('tallgrass', 'http://localhost:3000/public/map/tilesets/tallgrass.png');
				game.load.image('farming_fishing', 'http://localhost:3000/public/map/tilesets/farming_fishing.png');
				game.load.image('player', 'http://localhost:3000/public/map/character/phaser-dude.png');
			}
			
			var map,
				collisionLayer,
				alimentationLayer,
				cursors,
				player;
			function create() {				
				// 1. Create the map.
				game.stage.backgroundColor = '#787878';
				map = game.add.tilemap('game');
				map.addTilesetImage('tallgrass', 'tallgrass');
				map.addTilesetImage('farming_fishing', 'farming_fishing');
				collisionLayer = map.createLayer('Collision');
				alimentationLayer = map.createLayer('Alimentations');
				collisionLayer.resizeWorld();
				alimentationLayer.resizeWorld();
				
				// 2. Add the character and the camera
				game.physics.startSystem(Phaser.Physics.P2JS);
				player = game.add.sprite(0, 0, 'player');
				game.physics.p2.enable(player);
				player.body.fixedRotation = true;
				cursors = game.input.keyboard.createCursorKeys();			
				game.camera.follow(player, Phaser.Camera.FOLLOW_LOCKON, 0.1, 0.1);				
			}
			
			function update() {
				player.body.setZeroVelocity();
				if (cursors.up.isDown)
				{
					player.body.moveUp(300)
				}
				else if (cursors.down.isDown)
				{
					player.body.moveDown(300);
				}

				if (cursors.left.isDown)
				{
					player.body.velocity.x = -300;
				}
				else if (cursors.right.isDown)
				{
					player.body.moveRight(300);
				}
			}
		});
	</script>
</html>